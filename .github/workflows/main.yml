name: Run Unit Tests on Windows and Linux

on:
  pull_request:
    branches: [ main ]
  push:
    branches: [ main ]

jobs:
  test-windows:
    runs-on: windows-latest
    name: "Windows Tests"
    
    steps:
    - name: üì• Checkout code
      uses: actions/checkout@v3
      
    - name: üêç Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
        
    - name: üîß Install dependencies
      run: |
        python -m pip install --upgrade pip
        
    - name: üß™ Run tests on Windows
      run: |
        Write-Host "========================================"
        Write-Host "üß™  –ó–ê–ü–£–°–ö –¢–ï–°–¢–û–í –ù–ê WINDOWS  üß™"
        Write-Host "========================================"
        Write-Host ""
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
        python -m unittest tests.tests -v
        
        Write-Host ""
        Write-Host "üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ Windows:"
        if ($LASTEXITCODE -eq 0) {
          Write-Host "‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ –Ω–∞ Windows!"
        } else {
          Write-Host "‚ùå –¢–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å —Å –æ—à–∏–±–∫–∞–º–∏ –Ω–∞ Windows!"
          exit 1
        }
        
  test-linux:
    runs-on: ubuntu-latest
    name: "Linux Tests"
    
    steps:
    - name: üì• Checkout code
      uses: actions/checkout@v3
      
    - name: üêç Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
        
    - name: üîß Install dependencies
      run: |
        python -m pip install --upgrade pip
        
    - name: üß™ Run tests on Linux
      run: |
        echo "========================================"
        echo "üß™  –ó–ê–ü–£–°–ö –¢–ï–°–¢–û–í –ù–ê LINUX  üß™"
        echo "========================================"
        echo ""
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
        python -m unittest tests.tests -v
        
        echo ""
        echo "üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ Linux:"
        if [ $? -eq 0 ]; then
          echo "‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ –Ω–∞ Linux!"
        else
          echo "‚ùå –¢–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å —Å –æ—à–∏–±–∫–∞–º–∏ –Ω–∞ Linux!"
          exit 1
        fi
