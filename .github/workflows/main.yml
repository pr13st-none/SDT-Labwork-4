name: Run Unit Tests -> Windows and Linux

on:
  pull_request:
    branches: [ main ]
  push:
    branches: [ main ]

jobs:
  test-windows:
    runs-on: windows-latest
    name: "Windows tests"
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        
    - name: Run tests on Windows
      run: |
        python -m unittest testing.tests -v
        
        Write-Host ""
        Write-Host "Результаты выполнения на Windows:"
        if ($LASTEXITCODE -eq 0) {
          Write-Host "Все тесты пройдены успешно на windows!"
        } else {
          Write-Host "Тесты завершились с ошибками на windows!"
          exit 1
        }
        
  test-linux:
    runs-on: ubuntu-latest
    name: "Linux Tests"
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        
    - name: Run tests on Linux
      run: |
        python -m unittest testing.tests -v
        
        echo ""
        echo "Результаты выполнения на linux:"
        if [ $? -eq 0 ]; then
          echo "Все тесты пройдены успешно на linux!"
        else
          echo "Тесты завершились с ошибками на linux!"
          exit 1
        fi
